<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Transfer — CITI</title>
  <style>
    :root{
      --bg:#0f1724;
      --muted:#9aa4b2;
      --accent:#7c5cff;
      --glass: rgba(255,255,255,0.03);
      --success:#3bd671;
      --danger:#ff6b6b;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    html,body{height:100%;margin:0}
    body{
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(124,92,255,0.12), transparent 8%),
        radial-gradient(900px 400px at 90% 90%, rgba(0,200,190,0.05), transparent 10%),
        var(--bg);
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .container{
      width:980px;
      max-width:100%;
      display:grid;
      grid-template-columns:1fr 360px;
      gap:18px;
      align-items:start;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border:1px solid rgba(255,255,255,0.04);
      padding:18px;
      border-radius:12px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
    }

    .brand-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#fff,#f0f0f0)}
    .title{font-weight:700;font-size:16px;color:#f4f7fb}
    .subtitle{font-size:13px;color:var(--muted)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:8px}
    input[type="text"], input[type="number"], textarea{width:100%;padding:12px;border-radius:10px;background:var(--glass);border:1px solid rgba(255,255,255,0.03);color:#e8f0ff}
    .row{display:flex;gap:12px;margin-bottom:12px;align-items:end}
    .muted{color:var(--muted);font-size:13px}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 16px;border-radius:10px;cursor:pointer;border:0;font-weight:700;color:#08101a;background:linear-gradient(90deg,var(--accent),#5ec9ff);box-shadow: 0 8px 30px rgba(124,92,255,0.14)}
    .btn-ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04);box-shadow:none;padding:10px 12px;border-radius:10px}
    .history-list{margin-top:12px;display:flex;flex-direction:column;gap:10px;max-height:320px;overflow:auto;padding-right:6px}
    .tx{padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);display:flex;justify-content:space-between;align-items:center;border:1px solid rgba(255,255,255,0.02)}
    .tx .left{display:flex;flex-direction:column}
    .tx .title{font-weight:600;font-size:14px}
    .tx .meta{font-size:12px;color:var(--muted);margin-top:4px}
    .tx .amount{font-weight:800}
    .balance-card{display:flex;flex-direction:column;padding:16px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));border:1px solid rgba(255,255,255,0.03)}
    .balance-label{font-size:13px;color:var(--muted)}
    .balance-amount{font-size:28px;font-weight:700;margin-top:6px;color:#fff}
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1200}
    .modal{background:#fff;color:#111;border-radius:10px;max-width:720px;width:92%;padding:18px;box-shadow:0 12px 50px rgba(0,0,0,0.6)}
    @media (max-width:920px){ .container{grid-template-columns:1fr;gap:16px} .row{flex-direction:column} .btn,.btn-ghost{width:100%} }





:root{
  --bg:#0b1220; --panel:#07101a; --card:#0f1724;
  --muted:#98A0AD; --text:#E9F2FF; --accent:#9C7CFF; --accent-2:#00D4FF;
  --success:#7CFFCC; --danger:#FF7A7A;
  --radius:12px; --container:1180px; --gap:16px;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(600px 380px at 10% 10%, rgba(156,124,255,0.06), transparent 6%),
    radial-gradient(500px 300px at 90% 85%, rgba(0,212,255,0.03), transparent 8%),
    var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.45;
  letter-spacing:-0.01em;
  padding-bottom:100px;
}
.container{max-width:var(--container);margin:0 auto;padding:0 20px}

/* Header */
header.site-header{position:sticky;top:0;z-index:1200;padding-top:8px}
.header-top{display:flex;align-items:center;justify-content:space-between;padding:10px 0;background:linear-gradient(180deg, rgba(6,10,18,0.6), rgba(6,10,18,0.45));border-bottom:1px solid rgba(255,255,255,0.02);backdrop-filter:blur(6px)}
.nav-toggle{width:44px;height:44px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:grid;place-items:center;background:transparent;cursor:pointer}
.nav-toggle span{display:block;width:18px;height:2px;background:var(--muted);border-radius:2px}
.header-right .logo img{height:36px}
.header-sub{display:flex;align-items:center;padding:10px 0}
.secure-line{font-size:0.95rem;color:var(--muted)}
.member-line{font-size:0.88rem;color:var(--muted)}

/* Overlay */
.menu-overlay{display:none;position:fixed;inset:0;z-index:1500}
.overlay-panel{position:relative;max-width:360px;height:100%;right:0;background:var(--card);padding:18px;border-left:1px solid rgba(255,255,255,0.02)}

/* Secure banner */
.secure-banner{margin:16px auto;display:flex;align-items:center;gap:12px;padding:10px 20px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.02);color:var(--muted);font-size:0.95rem}

/* Layout */
main{padding:26px 0}
.grid{display:grid;grid-template-columns:1fr 360px;gap:20px;align-items:start}
.panel{padding:20px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.03);box-shadow:0 18px 50px rgba(2,6,23,0.6)}
h1{margin:0 0 12px 0;font-size:1.35rem}
.muted{color:var(--muted)}

/* Form */
.form-group{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
label{font-weight:600}
input[type="text"], input[type="number"], select, textarea { padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text); }
.inline-row{display:flex;gap:12px}
.btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;color:#07101a;padding:12px 16px;border-radius:10px;cursor:pointer;font-weight:700}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px 12px;border-radius:10px;color:var(--text);cursor:pointer}
.preview{margin-top:12px;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
.preview-row{display:flex;justify-content:space-between;gap:8px;padding:6px 0}

/* Right column */
.side-card{padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.03)}
.quick-list{display:flex;flex-direction:column;gap:8px}

/* Modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:center;justify-content:center;z-index:2200}
.modal{background:var(--card);padding:18px;border-radius:12px;width:520px;max-width:94%;border:1px solid rgba(255,255,255,0.03)}
.modal.open{display:block}

/* Responsive */
@media (max-width:1000px){ .grid{grid-template-columns:1fr} }
@media (max-width:720px){ .inline-row{flex-direction:column} .btn-primary{width:100%} }
button:focus, a:focus{outline:2px solid rgba(156,124,255,0.14);outline-offset:2px}

  </style>
</head>
<body>
  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="container header-top">
      <button id="nav-toggle" class="nav-toggle" aria-label="Open menu"><span aria-hidden="true"></span></button>
      <div class="header-right"><a class="logo" href="dashboard.html" aria-label="CITI Home"><img src="assets/citi_logo.png" alt="CITI Logo" /></a></div>
    </div>


    <!-- overlay -->
    <div class="menu-overlay" id="menu-overlay" aria-hidden="true">
      <div id="overlay-backdrop" style="position:absolute;inset:0;background:rgba(2,6,23,0.6)"></div>
      <div class="overlay-panel" role="dialog" aria-modal="true">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px">
          <a href="dashboard.html"><img src="assets/citi_logo.png" alt="CITI Logo" style="height:28px"/></a>
          <button id="overlay-close" class="overlay-close" aria-label="Close" style="background:none;border:none;color:var(--muted);font-size:22px">&times;</button>
        </div>
        <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:12px">
          <li><a href="dashboard.html#products" style="color:var(--text);text-decoration:none">Commercial Banking</a></li>
          <li><a href="dashboard.html#solutions" style="color:var(--text);text-decoration:none">Offshore Banking</a></li>
          <li><a href="dashboard.html#resources" style="color:var(--text);text-decoration:none">Mortgage Banking</a></li>
          <li><a href="dashboard.html#about" style="color:var(--text);text-decoration:none">About</a></li>
        </ul>
      </div>
    </div>
  </header>

  <!-- secure banner -->
  <div class="secure-banner container" role="status" aria-live="polite">
    <svg class="lock-icon" viewBox="0 0 24 24" aria-hidden="true" width="18" height="18"><path d="M12 1a5 5 0 0 0-5 5v4H6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2h-1V6a5 5 0 0 0-5-5z" fill="currentColor"/></svg>
    <span>You’re in a secure session — data is encrypted end-to-end.</span>
  </div>



  <div class="container" role="main">
    <div class="panel" aria-labelledby="panel-title">
      <div class="brand-row">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div id="panel-title" class="title">Transfer funds</div>
            <div class="subtitle">Mobile banking — USD</div>
          </div>
        </div>
        <div class="muted">Logged in as <strong>Hart Gijs</strong></div>
      </div>

      <form id="transferForm" autocomplete="off" novalidate>
        <div class="row">
          <div style="flex:1">
            <label for="recipientName">Recipient name</label>
            <input id="recipientName" name="recipientName" type="text" placeholder="Jane Doe" required />
          </div>
          <div style="width:120px">
            <label for="bankCode">Bank code</label>
            <input id="bankCode" name="bankCode" type="text" inputmode="numeric" placeholder="012" />
          </div>
        </div>

        <div class="row">
          <div style="flex:1">
            <label for="toAccount">Account number</label>
            <input id="toAccount" name="toAccount" type="text" inputmode="numeric" placeholder="1234567890" required />
          </div>
          <div style="width:120px">
            <label>Currency</label>
            <div class="muted">USD</div>
          </div>
        </div>

        <div style="margin-bottom:12px">
          <label for="amount">Amount</label>
          <input id="amount" name="amount" type="number" min="0.01" step="0.01" value="0.00" required />
        </div>

        <div style="margin-bottom:12px">
          <label for="note">Note (optional)</label>
          <input id="note" name="note" type="text" placeholder="For rent, invoice #123" />
        </div>

        <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
          <button type="submit" id="sendBtn" class="btn">Send transfer</button>
          <button type="button" id="resetBtn" class="btn-ghost">Reset</button>
          <div style="margin-left:auto" class="muted">Available balance <strong id="balanceDisplay">$883,601.45</strong></div>
        </div>

        <div class="muted helper" style="margin-top:8px">This balance updates immediately after each transfer</div>
      </form>

      <div style="margin-top:18px;display:flex;justify-content:space-between;align-items:center">
        <div class="subtitle">Recent activity</div>
        <div class="muted">Latest transfers and debits</div>
      </div>

      <div style="display:flex;gap:10px;margin-top:12px;align-items:center">
        <button id="clearHistory" class="btn-ghost">Clear</button>
        <!-- Top-up for testing: visible but small; remove in production -->
        <button id="topupBtn" class="btn-ghost" title="Add $500 for testing">Top up $500</button>
      </div>

      <div class="history-list" id="historyList" aria-live="polite"></div>
    </div>

    <aside class="panel balance-card" aria-labelledby="balance-title">
      <div>
        <div id="balance-title" class="balance-label">Available balance</div>
        <div class="balance-amount" id="balanceAmount">$0.00</div>
        <div class="muted" id="currencyNote">Currency: USD</div>
      </div>

      <div style="margin-top:18px">
        <div class="subtitle">Recent Transactions</div>
        <div class="muted" style="margin-top:6px">Showing debits</div>
        <div class="history-list" id="sideHistory"></div>
      </div>
    </aside>
  </div>

  <!-- Receipt Modal (in-page; printable via window.print) -->
  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" id="receiptModal" role="document" aria-labelledby="receiptTitle">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
        <div style="font-weight:700" id="receiptTitle">Transaction Receipt</div>
        <div style="display:flex;gap:8px">
          <button id="closeModal" class="btn-ghost">Close</button>
          <button id="printModal" class="btn">Print</button>
        </div>
      </div>
      <div id="receiptContent" style="font-size:14px;color:#222"></div>
    </div>
  </div>

  <script>
    /* Keys and config */
    const BALANCE_KEY = 'balance';
    const TX_KEY = 'transactions';
    const CURRENCY = 'USD';
    const SEED_BALANCE = 883,601.45; // seeded balance on first load

    /* Utility helpers */
    function safeParse(key, fallback){
      try { return JSON.parse(localStorage.getItem(key)) ?? fallback; } catch { return fallback; }
    }
    function formatCurrency(amount){
      try { return new Intl.NumberFormat(undefined, { style:'currency', currency: CURRENCY }).format(amount); }
      catch { return CURRENCY + ' ' + Number(amount).toFixed(2); }
    }
    function uid(){ return 'tx_' + Date.now().toString(36) + '_' + Math.random().toString(36).slice(2,8); }
    function escapeHtml(s){ if(s == null) return ''; return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'})[m]); }

    /* Storage primitives (no synthetic storage events) */
    function initStorage(){
      if(!localStorage.getItem(BALANCE_KEY)){
        localStorage.setItem(BALANCE_KEY, JSON.stringify({ amount: SEED_BALANCE, currency: CURRENCY }));
      }
      if(!localStorage.getItem(TX_KEY)){
        localStorage.setItem(TX_KEY, JSON.stringify([]));
      }
    }
    function getBalance(){ 
      const b = safeParse(BALANCE_KEY, { amount: 0.00, currency: CURRENCY });
      return { amount: Number(b.amount) || 0, currency: b.currency || CURRENCY };
    }
    function setBalance(b){ localStorage.setItem(BALANCE_KEY, JSON.stringify({ amount: Number(b.amount) || 0, currency: b.currency || CURRENCY })); }
    function getTxs(){ return safeParse(TX_KEY, []); }
    function setTxs(txs){ localStorage.setItem(TX_KEY, JSON.stringify(txs)); }

    /* Renderers */
    function renderBalance(){
      const b = getBalance();
      document.getElementById('balanceAmount').textContent = formatCurrency(b.amount);
      document.getElementById('balanceDisplay').textContent = formatCurrency(b.amount);
      document.getElementById('currencyNote').textContent = 'Currency: ' + CURRENCY;
    }

    function createTxRow(tx){
      const row = document.createElement('div');
      row.className = 'tx';
      const left = document.createElement('div'); left.className = 'left';
      const title = document.createElement('div'); title.className = 'title'; title.textContent = tx.description || (tx.type === 'debit' ? 'Debit' : 'Credit');
      const meta = document.createElement('div'); meta.className = 'meta'; meta.textContent = new Date(tx.timestamp).toLocaleString() + ' · To ' + (tx.toAccount || tx.to || 'external');
      left.appendChild(title); left.appendChild(meta);
      const amt = document.createElement('div'); amt.className = 'amount'; amt.textContent = (tx.type === 'debit' ? '-' : '') + formatCurrency(tx.amount);
      if(!tx.success) amt.style.color = 'var(--danger)';
      row.appendChild(left); row.appendChild(amt);
      return row;
    }

    function renderHistory(){
      const list = document.getElementById('historyList');
      const side = document.getElementById('sideHistory');
      list.innerHTML = ''; side.innerHTML = '';
      const txs = getTxs().slice().reverse();
      if(!txs.length){
        const none = document.createElement('div'); none.className = 'tx';
        none.innerHTML = '<div><div style="font-weight:600">No transactions</div><div class="meta">Your recent debits will appear here</div></div><div class="muted">—</div>';
        list.appendChild(none); side.appendChild(none.cloneNode(true));
        return;
      }
      txs.forEach(tx => {
        const row = createTxRow(tx);
        list.appendChild(row);
        side.appendChild(row.cloneNode(true));
      });
    }

    /* Receipt modal */
    const modalBackdrop = document.getElementById('modalBackdrop');
    const receiptContent = document.getElementById('receiptContent');
    const closeModalBtn = document.getElementById('closeModal');
    const printModalBtn = document.getElementById('printModal');

    function openReceiptModal(tx){
      receiptContent.innerHTML = `
        <div id="receipt-printable">
          <div style="padding-bottom:12px;border-bottom:1px solid #eee;margin-bottom:12px">
            <div style="font-weight:700;font-size:18px">Transaction Receipt</div>
            <div style="color:#666;font-size:12px;margin-top:6px">Transaction ID: ${escapeHtml(tx.id)}</div>
          </div>
          <div style="font-size:14px;color:#222">
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Recipient</strong></div><div>${escapeHtml(tx.recipientName)}</div></div>
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Account</strong></div><div>${escapeHtml(tx.toAccount)}</div></div>
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Bank code</strong></div><div>${escapeHtml(tx.bankCode || '—')}</div></div>
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Amount</strong></div><div style="font-weight:800">${formatCurrency(tx.amount)}</div></div>
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Note</strong></div><div>${escapeHtml(tx.description || '—')}</div></div>
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Date</strong></div><div>${new Date(tx.timestamp).toLocaleString()}</div></div>
            <div style="display:flex;justify-content:space-between;padding:8px 0"><div><strong>Status</strong></div><div>${tx.success ? 'Completed' : 'Failed'}</div></div>
          </div>
        </div>
      `;
      modalBackdrop.style.display = 'flex';
      modalBackdrop.setAttribute('aria-hidden', 'false');
      closeModalBtn.focus();
    }

    function closeReceiptModal(){
      modalBackdrop.style.display = 'none';
      modalBackdrop.setAttribute('aria-hidden', 'true');
      receiptContent.innerHTML = '';
    }

    printModalBtn.addEventListener('click', function(){ window.print(); });
    closeModalBtn.addEventListener('click', closeReceiptModal);
    modalBackdrop.addEventListener('click', function(e){ if(e.target === modalBackdrop) closeReceiptModal(); });

    /* Input parsing helper */
    function parseAmountInput(){
      const raw = (document.getElementById('amount').value || '').trim();
      const cleaned = raw.replace(/[^\d.-]/g, '');
      const v = parseFloat(cleaned);
      return Number.isFinite(v) ? v : NaN;
    }

    /* Transfer handler: validates, deducts or credits, logs tx, opens receipt modal */
    function onTransfer(e){
      e && e.preventDefault();
      const recipientName = document.getElementById('recipientName').value.trim();
      const toAccount = document.getElementById('toAccount').value.trim();
      const bankCode = document.getElementById('bankCode').value.trim();
      const amount = parseAmountInput();
      const description = (document.getElementById('note').value || '').trim() || 'Transfer';

      if(!recipientName){ alert('Please enter recipient name'); return; }
      if(!toAccount){ alert('Please enter account number'); return; }
      if(!Number.isFinite(amount) || amount <= 0){ alert('Enter an amount greater than 0'); return; }

      const balance = getBalance();
      if(amount > balance.amount + 1e-9){
        alert('Insufficient funds');
        return;
      }

      const tx = {
        id: uid(),
        timestamp: Date.now(),
        recipientName,
        toAccount,
        bankCode,
        amount: Number(amount),
        currency: CURRENCY,
        description,
        type: 'debit',
        success: true
      };

      // Persist: deduct and append
      const newBal = { amount: Number((balance.amount - amount).toFixed(2)), currency: CURRENCY };
      setBalance(newBal);
      const txs = getTxs();
      txs.push(tx);
      setTxs(txs);

      renderBalance();
      renderHistory();

      openReceiptModal(tx);
      document.getElementById('transferForm').reset();
    }

    /* Top up (testing) - credits balance and logs a credit transaction */
    function topUpTest(){
      const topAmount = 500.00; // change if needed
      const balance = getBalance();
      const newBal = { amount: Number((balance.amount + topAmount).toFixed(2)), currency: CURRENCY };
      setBalance(newBal);
      const tx = {
        id: uid(),
        timestamp: Date.now(),
        to: 'TopUp',
        amount: Number(topAmount),
        currency: CURRENCY,
        description: 'Top up (test)',
        type: 'credit',
        success: true
      };
      const txs = getTxs();
      txs.push(tx);
      setTxs(txs);
      renderBalance();
      renderHistory();
      alert(`Account credited ${formatCurrency(topAmount)} for testing.`);
    }

    /* Form and control wiring */
    document.getElementById('transferForm').addEventListener('submit', onTransfer);
    document.getElementById('resetBtn').addEventListener('click', function(){ if(confirm('Reset the transfer form?')) document.getElementById('transferForm').reset(); });
    document.getElementById('clearHistory').addEventListener('click', function(){
      if(!confirm('Clear transaction history? This cannot be undone.')) return;
      setTxs([]); renderHistory();
    });
    document.getElementById('topupBtn').addEventListener('click', topUpTest);

    /* Storage event listener (native cross-tab updates only) */
    window.addEventListener('storage', function(e){
      if(e.key === BALANCE_KEY) renderBalance();
      if(e.key === TX_KEY) renderHistory();
    });

    /* Init */
    (function init(){
      initStorage();
      renderBalance();
      renderHistory();
      // Prefill convenience values
      document.getElementById('recipientName').value = 'Jane Doe';
      document.getElementById('toAccount').value = '1234567890';
      document.getElementById('bankCode').value = '012';
      document.getElementById('amount').value = '0.00';
      document.getElementById('note').value = 'For rent, invoice #123';
      document.getElementById('currencyNote').textContent = 'Currency: ' + CURRENCY;
      window._citi = { getBalance, getTxs }; // debug helpers
    })();

    /* Exposed internal helpers (kept near bottom for clarity) */
    function getBalance(){ const b = safeParse(BALANCE_KEY, { amount: 0.00, currency: CURRENCY }); return { amount: Number(b.amount) || 0, currency: b.currency || CURRENCY }; }
    function setBalanceObj(b){ localStorage.setItem(BALANCE_KEY, JSON.stringify({ amount: Number(b.amount) || 0, currency: b.currency || CURRENCY })); }
    function getTxs(){ return safeParse(TX_KEY, []); }
    function setTxs(txs){ localStorage.setItem(TX_KEY, JSON.stringify(txs)); }
    // keep setBalance alias used above
    function setBalance(b){ setBalanceObj(b); }
    function initStorage(){ if(!localStorage.getItem(BALANCE_KEY)) localStorage.setItem(BALANCE_KEY, JSON.stringify({ amount: SEED_BALANCE, currency: CURRENCY })); if(!localStorage.getItem(TX_KEY)) localStorage.setItem(TX_KEY, JSON.stringify([])); }
  </script>
</body>
</html>
