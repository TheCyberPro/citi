<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Withdraw — CITI</title>
  <style>
    :root{
      --bg:#0f1724;
      --muted:#9aa4b2;
      --accent:#7c5cff;
      --glass: rgba(255,255,255,0.03);
      --success:#3bd671;
      --danger:#ff6b6b;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(124,92,255,0.12), transparent 8%),
        radial-gradient(900px 400px at 90% 90%, rgba(0,200,190,0.05), transparent 10%),
        var(--bg);
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .card{
      width:760px;
      max-width:96%;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
      border:1px solid rgba(255,255,255,0.04);
      padding:20px;
      border-radius:12px;
      box-shadow: 0 6px 30px rgba(2,6,23,0.6);
    }

    .brand{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#fff,#f0f0f0)}
    h1{margin:0;font-size:18px}
    .muted{color:var(--muted);font-size:13px}

    label{display:block;font-size:13px;color:var(--muted);margin-top:10px;margin-bottom:8px}
    input,select,button,textarea{
      width:100%;
      padding:12px;
      border-radius:10px;
      background:var(--glass);
      border:1px solid rgba(255,255,255,0.03);
      color:#e8f0ff;
      font-size:14px;
      outline:none;
    }

    .row{display:flex;gap:12px}
    .btn{background:linear-gradient(90deg,var(--accent),#5ec9ff);border:0;padding:12px;border-radius:10px;color:#08101a;font-weight:700;cursor:pointer}
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);cursor:pointer;border-radius:10px;padding:10px 12px}

    .history{margin-top:16px;display:flex;flex-direction:column;gap:10px;max-height:220px;overflow:auto}
    .tx{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;display:flex;justify-content:space-between;align-items:center}
    .tx .meta{font-size:13px;color:var(--muted)}

    @media (max-width:720px){
      .row{flex-direction:column}
      .card{padding:16px}
    }
  </style>
</head>
<body>
  <div class="card" role="main">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Withdraw funds</h1>
        <div class="muted">Withdraw to a saved bank or card</div>
      </div>
    </div>

    <form id="withdrawForm" autocomplete="off" novalidate>
      <label for="withdrawTo">Withdraw to</label>
      <select id="withdrawTo" name="withdrawTo">
        <option value="bank_1">Saved bank •••• 7890</option>
        <option value="card_1">Card •••• 4242</option>
      </select>

      <label for="withdrawAmount">Amount</label>
      <input id="withdrawAmount" name="withdrawAmount" type="number" min="0.01" step="0.01" value="0.00" />

      <div style="display:flex;gap:12px;margin-top:12px">
        <button type="submit" class="btn" style="flex:1">Withdraw</button>
        <button type="button" id="withdrawReset" class="btn-ghost" style="width:140px">Reset</button>
      </div>
    </form>

    <div style="margin-top:14px">
      <div class="muted">Available balance <strong id="withdrawBalance">$0.00</strong></div>
      <div class="muted" style="margin-top:6px">This balance updates immediately after each withdrawal</div>
    </div>

    <div style="margin-top:16px">
      <div class="muted">Recent activity</div>
      <div class="history" id="withdrawHistory" aria-live="polite"></div>
    </div>
  </div>

  <script>
    const BALANCE_KEY = 'balance';
    const TX_KEY = 'transactions';
    const CURRENCY = 'USD';

    function safeParse(key, fallback){ try { return JSON.parse(localStorage.getItem(key)) ?? fallback; } catch { return fallback; } }
    function formatCurrency(amount){
      try { return new Intl.NumberFormat(undefined, { style: 'currency', currency: CURRENCY }).format(amount); }
      catch { return (CURRENCY ? CURRENCY + ' ' : '') + Number(amount).toFixed(2); }
    }
    function uid(){ return 'tx_' + Date.now().toString(36) + '_' + Math.random().toString(36).slice(2,8); }

    function initStorage(){
      if(!localStorage.getItem(BALANCE_KEY)) localStorage.setItem(BALANCE_KEY, JSON.stringify({ amount: 0.00, currency: CURRENCY }));
      if(!localStorage.getItem(TX_KEY)) localStorage.setItem(TX_KEY, JSON.stringify([]));
    }
    function getBalance(){ return safeParse(BALANCE_KEY, { amount:0.00, currency: CURRENCY }); }
    function setBalance(b){ localStorage.setItem(BALANCE_KEY, JSON.stringify(b)); }
    function getTxs(){ return safeParse(TX_KEY, []); }
    function setTxs(txs){ localStorage.setItem(TX_KEY, JSON.stringify(txs)); }

    function renderBalance(){ const b = getBalance(); document.getElementById('withdrawBalance').textContent = formatCurrency(b.amount); }
    function renderWithdrawHistory(){
      const list = document.getElementById('withdrawHistory'); list.innerHTML = '';
      const txs = getTxs().slice().reverse();
      if(!txs.length){ const none=document.createElement('div'); none.className='tx'; none.innerHTML = '<div>No transactions</div><div class="meta">—</div>'; list.appendChild(none); return; }
      txs.forEach(tx => {
        if(tx.type !== 'debit') return;
        const row = document.createElement('div'); row.className='tx';
        row.innerHTML = `<div><div><strong>${tx.description||'Withdrawal'}</strong></div><div class="meta">${new Date(tx.timestamp).toLocaleString()} · To ${tx.to||'external'}</div></div><div>${formatCurrency(tx.amount)}</div>`;
        list.appendChild(row);
      });
    }

    document.getElementById('withdrawForm').addEventListener('submit', function(e){
      e.preventDefault();
      const amount = parseFloat(document.getElementById('withdrawAmount').value);
      if(!amount || isNaN(amount) || amount <= 0){ alert('Enter an amount greater than 0'); return; }
      const balance = getBalance();
      if(amount > balance.amount){ alert('Insufficient funds'); return; }

      const tx = { id: uid(), timestamp: Date.now(), to: document.getElementById('withdrawTo').value, amount: Number(amount), currency: balance.currency, description: 'Withdraw', type: 'debit', success: true };

      const newBal = { amount: Number((balance.amount - amount).toFixed(2)), currency: balance.currency };
      setBalance(newBal);
      const txs = getTxs(); txs.push(tx); setTxs(txs);

      renderBalance(); renderWithdrawHistory();
      alert('Withdrawal recorded and added to transaction history.');
      document.getElementById('withdrawForm').reset();
    });

    document.getElementById('withdrawReset').addEventListener('click', function(){ if(confirm('Reset withdraw form?')) document.getElementById('withdrawForm').reset(); });

    window.addEventListener('storage', function(e){ if(e.key === BALANCE_KEY) renderBalance(); if(e.key === TX_KEY) renderWithdrawHistory(); });

    (function init(){ initStorage(); renderBalance(); renderWithdrawHistory(); })();
  </script>
</body>
</html>
